<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • threesixtygiving</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="threesixtygiving">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90706059-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-90706059-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threesixtygiving</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://docs.evanodell.com">Docs Home</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="https://docs.evanodell.com">All Packages</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EvanOdell/threesixtygiving">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://evanodell.com">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/evanodell/threesixtygiving/blob/master/../docs/vignettes/introduction.Rmd"><code>../docs/vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>This article describes a software package for the 360Giving platform, written in the <a href="https://cran.r-project.org/">R programming language</a>. R is particularly good for statistics and data visualisation, and is widely used by journalists, academics and data analysts. I have created <a href="https://docs.evanodell.com">quite a few R packages</a> that retrieve data from all kinds of sources, with similar aims to <code>threesixtygiving</code>.</p>
<p>I’ve created this package to access data from 360Giving, a data standard for publishing information about charitable grant giving in the UK. The ability to search for and query different data is similar to the <a href="https://grantnav.threesixtygiving.org/">GrantNav</a> tool created by 360Giving. There are several advantages to using the software package instead of GrantNav:</p>
<ol style="list-style-type: decimal">
<li><p>It lets you retrieve 360Giving data, search and summarise that data, create charts and tables and write text using a single file. This is very useful for nerds like me – this entire article comes from a single computer file that contains both this text and the computer code used to generate all the graphs.</p></li>
<li><p>It gives you access to the raw data provided by funders. The 360Giving standard allows for optional information that is not provided by most funders or included in GrantNav. This information can be useful to fundraising managers in some situations, as well as to researchers wanting to understand the size, scope and approaches to charitable trust giving in the UK.</p></li>
<li><p><code>threesixtygiving</code> returns data in types and structures designed for R. I’ve done the work of mucking around with file organising and processing to ensure consistency across various file sources, such as ensuring that the dozens of possible date formats are converted to the R <code>Date</code> class.</p></li>
</ol>
<p>The big disadvantage is that the <code>threesixtygiving</code> package is mucher harder to use than GrantNav is. For a lot of people and use-cases <code>threesixtygiving</code> is overkill. If you’re not familiar with R and data analysis isn’t a big part of your job, you probably don’t need this package. But let me evangelise R for a bit.</p>
<p>Say you want to know the average grant size given by each of the funders in GrantNav, and you’ve downloaded the CSV file with all their data from GrantNav (and the CSV file download completely and saved, because sometimes the internet cuts out and you lose a bunch of rows without warning and the file still opens, and it isn’t until you’re presenting your results to SMT that for some reason you have no data on what the Big Lottery has funded). Here are your steps:</p>
<ol style="list-style-type: decimal">
<li><p>Create a new worksheet.</p></li>
<li><p>Locate the “Funding Org:Name” column.</p></li>
<li><p>Copy and paste “Funding Org:Name” column into the new worksheet.</p></li>
<li><p>Highlight the entire column, then click the “Remove Duplicates” button.</p></li>
<li><p>Type the name of the <code>=AVERAGEIF</code> formula in the column next to your column of removed duplicate funding org names.</p></li>
<li><p>Click into your old worksheet, select the “Amount Awarded” column.</p></li>
<li><p>Realise that <code>=AVERAGEIF</code> and <code>=AVERAGEIFs</code> want data in a different order. Press escape. Click back to your new worksheet. Change <code>=AVERAGEIF</code> to <code>=AVERAGEIFs</code>.</p></li>
<li><p>Select the “Amount Awarded” column, than the “Funding Org:Name”, then click back to you new work sheet and select the single cell in your column of removed duplicate funding org names.</p></li>
<li><p>Double click to fill the column. Realise you have a bunch of errors because you forgot to press F4 or put dollar signs into the first two ranges in your formula.</p></li>
<li><p>Realise that a bunch of grants are in a currency other than pounds. Waste 10 minutes weighing the pros and cons of deleting them, then realise that you have no easy way to convert those currencies to pounds. Delete those rows, hope you haven’t accidentally lost anything you wanted.</p></li>
<li><p>Your boss asks for average grant value per year. Realise that roughly 89% of dates have time zone information encoded and Excel couldn’t figure out how to process it. Realise that this is probably the first time in history that Excel has made someone’s life difficult by <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7"><em>not</em> assuming everything is a date</a>.</p></li>
<li><p>Take a break. Have a cup of tea. Wonder vaguely if stuff like this is the reason the UK struggles with low productivity-per-hour. Feel a twinge of envy of hunter-gatherer societies.</p></li>
</ol>
<p>Now, here’s how you do it in R. The bits with “#”’s in front of them are comments, they are little notes you can write to yourself so you remember what you did, or so someone else can read your code and know what you’re doing.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">threesixtygiving</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>) <span class="co">## A package used to manipulate and process data</span>

<span class="co"># Download all the grant data available.</span>
<span class="co"># It comes out in a list of tibbles but that's not a problem:</span>
<span class="no">grants</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_all_grants.html">tsg_all_grants</a></span>(<span class="kw">timeout</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">retries</span> <span class="kw">=</span> <span class="fl">0</span>)

<span class="co"># Get just the core data required by the 360Giving standard.</span>
<span class="co"># Convert that list of tibbles into a tidy format:</span>
<span class="no">all_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_core_data.html">tsg_core_data</a></span>(<span class="no">grants</span>)

<span class="no">avg_size</span> <span class="kw">&lt;-</span> <span class="no">all_data</span> <span class="kw">%&gt;%</span> <span class="co">#This %&gt;% thing is a called a pipe. Pipes are love. Pipes are life.</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">currency</span> <span class="kw">==</span> <span class="st">"GBP"</span>) <span class="kw">%&gt;%</span> <span class="co"># Filter out non-£ data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">funding_org_name</span>) <span class="kw">%&gt;%</span> <span class="co"># Group all the funders together</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">avg</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">amount_awarded</span>)) <span class="co"># Get the average of given value for each group, kinda like =AVERAGEIFS in Excel.</span>

<span class="no">avg_size</span>

<span class="co"># # A tibble: 109 x 2</span>
<span class="co">#    funding_org_name                             avg</span>
<span class="co">#    &lt;chr&gt;                                      &lt;dbl&gt;</span>
<span class="co">#  1 A B Charitable Trust                      13714.</span>
<span class="co">#  2 Barrow Cadbury Trust                      35889.</span>
<span class="co">#  3 BBC Children in Need                      55968.</span>
<span class="co">#  4 Birmingham City Council                   32097.</span>
<span class="co">#  5 Calouste Gulbenkian Foundation, UK Branch 34352.</span>
<span class="co">#  6 Camden Giving                             18254.</span>
<span class="co">#  7 Cheshire Community Foundation              6027.</span>
<span class="co">#  8 City Bridge Trust                         81381.</span>
<span class="co">#  9 Cloudesley                                14441.</span>
<span class="co"># 10 Co-operative Group                         3238.</span>
<span class="co"># # ... with 99 more rows</span></pre></body></html></div>
<p>Your boss comes and asks for average per year? Spot the difference:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">
<span class="no">avg_size_year</span> <span class="kw">&lt;-</span> <span class="no">all_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">currency</span> <span class="kw">==</span> <span class="st">"GBP"</span>) <span class="kw">%&gt;%</span> <span class="co"># Filter out non-£ data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">funding_org_name</span>, <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(<span class="no">award_date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">avg</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">amount_awarded</span>))

<span class="no">avg_size_year</span>

<span class="co"># # A tibble: 599 x 3</span>
<span class="co"># # Groups:   funding_org_name [109]</span>
<span class="co">#    funding_org_name     `lubridate::year(award_date)`    avg</span>
<span class="co">#    &lt;chr&gt;                                        &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#  1 A B Charitable Trust                          2013  9407.</span>
<span class="co">#  2 A B Charitable Trust                          2014 10008.</span>
<span class="co">#  3 A B Charitable Trust                          2015 10797.</span>
<span class="co">#  4 A B Charitable Trust                          2016 13689.</span>
<span class="co">#  5 A B Charitable Trust                          2017 16110.</span>
<span class="co">#  6 A B Charitable Trust                          2018 15619.</span>
<span class="co">#  7 A B Charitable Trust                          2019 19387.</span>
<span class="co">#  8 Barrow Cadbury Trust                          2012 31920.</span>
<span class="co">#  9 Barrow Cadbury Trust                          2013 34753.</span>
<span class="co"># 10 Barrow Cadbury Trust                          2014 30378.</span>
<span class="co"># # ... with 589 more rows</span></pre></body></html></div>
<p>The <code><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_all_grants.html">tsg_all_grants()</a></code> function retrieves all the grant data. And if data isn’t available, or there is a downloading error, it will print a message warning you. No more silently failing downloads. There is even a <code><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_missing.html">tsg_missing()</a></code> function, which will take the output of <code><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_all_grants.html">tsg_all_grants()</a></code> and tell you what’s missing. Brilliant eh?</p>
<p>Say you want to include all the grants that are in currencies other than pounds, but convert their value to pounds? In the example below I show a way to do that where I just looked up the currency conversion rates on my phone and changed the currency based on that, but you could also write some code that takes the currency code, the award date, and passes them to the <a href="https://fixer.io" class="uri">https://fixer.io</a> currency conversion service using the <a href="https://cran.r-project.org/package=fixerapi"><code>fixerapi</code></a> package, which provided you have the right account type, will convert the currency value to pound using the conversion rate on the day the grant was awarded. Pretty cool, if you’re into that sort of thing.</p>
<div id="retrieve-all-grants" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieve-all-grants" class="anchor"></a>Retrieve all grants</h2>
<p>Below are all the R packages that I’m using create the graphs and such in this article.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">threesixtygiving</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<p>First, I’m going to retrieve all the grant data. The <code>timeout = 8</code> means I’m having the function give up trying to retrieve data after 8 seconds for each file, and <code>retries = 1</code> means it is only going to retry failed retrievals once, then it will give up and move on to retrieve the next data set.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">grants</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_all_grants.html">tsg_all_grants</a></span>(<span class="kw">timeout</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">retries</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p>Because of my minimal timeout and retries, as well as possible other problems with how organisations configure their servers, there are some datasets missing:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_missing.html">tsg_missing</a></span>(<span class="no">grants</span>)

<span class="co"># # A tibble: 7 x 14</span>
<span class="co">#   title description identifier license license_name issued modified download_url access_url data_type</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;    </span>
<span class="co"># 1 Gran~ ""          a001p0000~ https:~ Creative Co~ 2019-~ 2019-11~ https://jof~ https://j~ xlsx     </span>
<span class="co"># 2 Gran~ ""          a00240000~ https:~ Creative Co~ 2017-~ 2018-08~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 3 Gran~ ""          a00240000~ https:~ Creative Co~ 2017-~ 2018-08~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 4 Gran~ ""          a001p0000~ https:~ Creative Co~ 2018-~ 2019-03~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 5 Gran~ ""          a001p0000~ https:~ Creative Co~ 2018-~ 2019-08~ https://tud~ https://t~ xlsx     </span>
<span class="co"># 6 True~ ""          a00240000~ https:~ Creative Co~ 2016-~ 2018-08~ http://ods.~ http://ww~ unknown  </span>
<span class="co"># 7 Wood~ ""          a001p0000~ https:~ Creative Co~ 2017-~ 2018-08~ http://ods.~ http://ww~ unknown  </span>
<span class="co"># # ... with 4 more variables: publisher_name &lt;chr&gt;, publisher_website &lt;chr&gt;, publisher_logo &lt;chr&gt;,</span>
<span class="co"># #   publisher_prefix &lt;chr&gt;</span></pre></body></html></div>
<p>However, we know they are missing, and we can retry downloading just them if needed using the <code><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_specific_df.html">tsg_specific_df()</a></code> function. But I’ll ignore them for now.</p>
</div>
<div id="core-data" class="section level2">
<h2 class="hasAnchor">
<a href="#core-data" class="anchor"></a>Core data</h2>
<p><code>tsg_all_grants</code> returns a list of tibbles, due to differences in the data provided by each funder. <code>tsg_core_data</code> returns a tibble with the 10 columns in the <a href="https://standard.threesixtygiving.org/en/latest/#">360Giving Open Standard</a>, plus the publisher prefix used to identify each funder. In the case below I have converted non-GBP currencies to GBP on the rates on 2019-11-14.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_core_data.html">tsg_core_data</a></span>(<span class="no">grants</span>)

<span class="no">df2</span> <span class="kw">&lt;-</span> <span class="no">df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">amount_awarded</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
    <span class="no">currency</span> <span class="kw">==</span> <span class="st">"USD"</span> ~ <span class="no">amount_awarded</span>/<span class="fl">1.3044</span>, <span class="co">## rate on 2020-01-17</span>
    <span class="no">currency</span> <span class="kw">==</span> <span class="st">"CAD"</span> ~ <span class="no">amount_awarded</span>/<span class="fl">1.7017</span>,
    <span class="no">currency</span> <span class="kw">==</span> <span class="st">"CHF"</span> ~ <span class="no">amount_awarded</span>/<span class="fl">1.2630</span>,
    <span class="no">currency</span> <span class="kw">==</span> <span class="st">"EUR"</span> ~ <span class="no">amount_awarded</span>/<span class="fl">1.1750</span>,
    <span class="fl">TRUE</span> ~ <span class="no">amount_awarded</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">funding_org_name</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>(),
            <span class="kw">amount_awarded</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">amount_awarded</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">avg</span> <span class="kw">=</span> <span class="no">amount_awarded</span>/<span class="no">n</span>)</pre></body></html></div>
<p>Now I’ve made a bunch of graphs highlighting what you can do with</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>())

<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">20</span>, <span class="no">amount_awarded</span>) <span class="kw">%&gt;%</span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">amount_awarded2</span> <span class="kw">=</span> <span class="no">amount_awarded</span>/<span class="fl">100000</span>),
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">funding_org_name</span>, -<span class="no">amount_awarded2</span>),
                 <span class="kw">y</span> <span class="kw">=</span> <span class="no">amount_awarded2</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">amount_awarded2</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_sqrt</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>(<span class="kw">prefix</span> <span class="kw">=</span> <span class="st">"£"</span>),
               <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1000</span>, <span class="fl">5000</span>, <span class="fl">10000</span>, <span class="fl">25000</span>, <span class="fl">50000</span>, <span class="fl">75000</span>, <span class="fl">100000</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_wrap.html">wrap_format</a></span>(<span class="fl">30</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Funder"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Amount Awarded 
       (in 100,000s, note square-root scale)"</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Total Value of Grants Awarded by Twenty Largest Funders"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">p1</span></pre></body></html></div>
<p><img src="total-value.png"></p>
<p>The plot below shows the average grant value from each funder, with the number of reported grants given by each funder.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">p2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">20</span>, <span class="no">amount_awarded</span>),
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">funding_org_name</span>, -<span class="no">avg</span>),
                 <span class="kw">y</span> <span class="kw">=</span> <span class="no">avg</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">avg</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>() +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>(<span class="no">n</span>)), <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="fl">1</span>,
              <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.35</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3.25</span>, <span class="kw">hjust</span> <span class="kw">=</span><span class="fl">0.5</span>, <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"y"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_sqrt</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>(<span class="kw">prefix</span> <span class="kw">=</span> <span class="st">"£"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_wrap.html">wrap_format</a></span>(<span class="fl">25</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Funder"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Average Grant Value"</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Average Grant Value"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Label is the total number of grants awarded"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">8</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">p2</span></pre></body></html></div>
<p><img src="avg-grant-value.png"></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">p3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">df2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">avg</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">amount_awarded</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.7</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">4</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">5</span>, <span class="no">avg</span>),
                                   <span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">5</span>, <span class="no">amount_awarded</span>),
                                   <span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">5</span>, <span class="no">n</span>),
                                   <span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">5</span>, -<span class="no">n</span>),
                                   <span class="no">df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">5</span>, -<span class="no">amount_awarded</span>)) <span class="kw">%&gt;%</span>
                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>(),
                  <span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">funding_org_name</span>), <span class="kw">colour</span> <span class="kw">=</span> <span class="st">"black"</span>,
                  <span class="kw">direction</span> <span class="kw">=</span> <span class="st">"both"</span>,
                  <span class="kw">arrow</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">arrow</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>),
                                <span class="kw">type</span> <span class="kw">=</span> <span class="st">"open"</span>, <span class="kw">ends</span> <span class="kw">=</span> <span class="st">"last"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>(<span class="kw">prefix</span> <span class="kw">=</span> <span class="st">"£"</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="st">"Average Grant Value"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"Number of Grants"</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Average Grant Value vs Number of Grants"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>)

<span class="no">p3</span></pre></body></html></div>
<p>In the the plot below I’ve highlighted funders that make very many or very few grants, and that are either very large or very small.</p>
<p><img src="grant-size-n.png"></p>
<div id="award-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#award-sizes" class="anchor"></a>Award sizes</h3>
<p>In the two examples below, we can see differences between the amount of money applied for and the amount awarded. Not every funder reports the amount applied for, and some report what seem like placeholder values, such as grant programmes where applicants do not need to specify the value of the grant, only what they want to do and leave the award amount up to the funder.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">proc_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_process_data.html">tsg_process_data</a></span>(<span class="no">grants</span>)

<span class="no">proc_amount_df</span> <span class="kw">&lt;-</span> <span class="no">proc_df</span>  <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">identifier</span>, <span class="no">title</span>, <span class="no">description</span>, <span class="no">funding_org_name</span>,
         <span class="no">amount_awarded</span>, <span class="no">amount_applied_for</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span>(<span class="kw">.vars</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">amount_awarded</span>, <span class="no">amount_applied_for</span>), <span class="no">as.numeric</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">difference</span> <span class="kw">=</span> <span class="no">amount_awarded</span>-<span class="no">amount_applied_for</span>,
         <span class="kw">percentage_of</span> <span class="kw">=</span> <span class="no">amount_awarded</span>/<span class="no">amount_applied_for</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">amount_applied_for</span>), <span class="no">amount_applied_for</span> <span class="kw">&gt;</span> <span class="fl">2500</span>,
         <span class="no">amount_awarded</span> <span class="kw">&gt;</span> <span class="fl">2500</span>,
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">percent_rank</a></span>(<span class="no">difference</span>) <span class="kw">&gt;=</span> <span class="fl">0.02</span> <span class="kw">&amp;</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">percent_rank</a></span>(<span class="no">difference</span>) <span class="kw">&lt;=</span> <span class="fl">0.98</span>) <span class="kw">%&gt;%</span> <span class="co">## remove outliers</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">difference</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">difference</span>))

<span class="no">count0</span> <span class="kw">&lt;-</span> <span class="no">proc_amount_df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">difference</span><span class="kw">==</span><span class="fl">0</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tally.html">tally</a></span>()

<span class="no">p4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">proc_amount_df</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">difference</span> <span class="kw">!=</span> <span class="fl">0</span>),
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">difference</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">100</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">4000</span>,
        <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>(<span class="no">n</span>),
                       <span class="st">" applications awarded exact amount applied for"</span>)),
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">count0</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_dollar.html">dollar_format</a></span>(<span class="kw">prefix</span> <span class="kw">=</span> <span class="st">"£"</span>),
                     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">20000</span>, -<span class="fl">10000</span>, -<span class="fl">5000</span>, -<span class="fl">2500</span>,
                                <span class="fl">0</span>, <span class="fl">2500</span>, <span class="fl">5000</span>, <span class="fl">7500</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Difference between Award and Application Amount"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Number of Grants"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>)

<span class="no">p4</span></pre></body></html></div>
<p><img src="grant-diff-value.png"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">p5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">proc_amount_df</span> <span class="kw">%&gt;%</span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">difference</span> <span class="kw">!=</span> <span class="fl">0</span>, <span class="no">percentage_of</span> <span class="kw">!=</span> <span class="fl">Inf</span>),
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">percentage_of</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">200</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">3000</span>, <span class="kw">hjust</span> <span class="kw">=</span> <span class="fl">1</span>,
        <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>(<span class="no">n</span>),
                       <span class="st">" applications awarded exact amount applied for"</span>)),
    <span class="kw">data</span> <span class="kw">=</span> <span class="no">count0</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_number.html">comma</a></span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_percent.html">percent</a></span>,
                     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="fl">2</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Award size as percentage of amount applied for"</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Number of Grants"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>)

<span class="no">p5</span></pre></body></html></div>
<p><img src="grant-diff-perc.png"></p>
</div>
<div id="systemic-change-funders" class="section level3">
<h3 class="hasAnchor">
<a href="#systemic-change-funders" class="anchor"></a>Systemic change funders</h3>
<p>Organisations that are focused on systemic change and policy-influencing seem to be particularly reliant on trusts and foundations for income. This may be because charitable trusts, particularly large, professionalised funders, have different criteria than members of the public donating money. The most popular type of charity for public donations is animal welfare, according to the <a href="https://www.cafonline.org/docs/default-source/about-us-publications/caf-uk-giving-2019-report-an-overview-of-charitable-giving-in-the-uk.pdf?sfvrsn=c4a29a40_4">Charities Aid Foundation</a>, likely because of the emotional connection many people feel with animals.</p>
<p>The code below is going to get a little bit more complicated, it includes some very basic functional programming and regular expressions. If you don’t know what functional programming is, it’s basically a way of turning everything into a mathematical formula. If you don’t know what regular expressions are, count yourself lucky.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">proc_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/threesixtygiving/man/tsg_process_data.html">tsg_process_data</a></span>(<span class="no">grants</span>)

<span class="no">animal_df</span> <span class="kw">&lt;-</span> <span class="no">proc_df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter_all.html">filter_at</a></span>(<span class="kw">.vars</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">description</span>, <span class="no">title</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"primary"</span>),
                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"impact"</span>), <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"category"</span>),
                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"classificat"</span>)),
            <span class="kw">.vars_predicate</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_vars.html">any_vars</a></span>(
              <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">.</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">regex</a></span>(<span class="st">'animal'</span>,
                                  <span class="kw">ignore_case</span><span class="kw">=</span><span class="fl">TRUE</span>))
              ))

<span class="no">strat_df</span> <span class="kw">&lt;-</span> <span class="no">proc_df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter_all.html">filter_at</a></span>(<span class="kw">.vars</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">description</span>, <span class="no">title</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"primary"</span>),
                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"impact"</span>), <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"category"</span>),
                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">contains</a></span>(<span class="st">"classificat"</span>)),
            <span class="kw">.vars_predicate</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_vars.html">any_vars</a></span>(
              <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">.</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">regex</a></span>(<span class="st">'strategy|strategic|systemic'</span>,
                                  <span class="kw">ignore_case</span><span class="kw">=</span><span class="fl">TRUE</span>))
              ))</pre></body></html></div>
<p>For example, there are 1673 donations to animal-related organisations from 23 trusts in this dataset, compared to 2897 strategic and system change grants from 75 funders. However there do not appear to be any funders focused on strategic funding and systemic change. The plot below shows the twenty funders that have allocated the greatest percentages of their overall funding to what I’ve deemed strategic issues.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">proc_df</span> <span class="kw">&lt;-</span> <span class="no">proc_df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    <span class="kw">strategic</span> <span class="kw">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">description</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">regex</a></span>(<span class="st">'strategy|strategic|systemic'</span>,
                                  <span class="kw">ignore_case</span><span class="kw">=</span><span class="fl">TRUE</span>)
              )
  )

<span class="no">proc_df2</span> <span class="kw">&lt;-</span> <span class="no">proc_df</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">funding_org_name</span>, <span class="no">strategic</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">total</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">amount_awarded</span>),
            <span class="kw">mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">amount_awarded</span>),
            <span class="kw">median</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">amount_awarded</span>),
            <span class="kw">n</span><span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">funding_org_name</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">perc_strat</span> <span class="kw">=</span> <span class="no">total</span>/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">total</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>()

<span class="no">twenty_strats</span> <span class="kw">&lt;-</span> <span class="no">proc_df2</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">strategic</span><span class="kw">==</span><span class="fl">TRUE</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="fl">20</span>, <span class="no">perc_strat</span>)

<span class="no">p6</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">twenty_strats</span>,
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span>(<span class="no">funding_org_name</span>, -<span class="no">perc_strat</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">perc_strat</span>,
                 <span class="kw">fill</span> <span class="kw">=</span> <span class="no">perc_strat</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"dodge"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="no"><a href="https://scales.r-lib.org//reference/label_percent.html">percent</a></span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="kw">labels</span> <span class="kw">=</span> <span class="kw pkg">scales</span><span class="kw ns">::</span><span class="fu"><a href="https://scales.r-lib.org//reference/label_wrap.html">wrap_format</a></span>(<span class="fl">25</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="kw">angle</span> <span class="kw">=</span> <span class="fl">45</span>, <span class="kw">hjust</span><span class="kw">=</span><span class="fl">1</span>),
        <span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">"none"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"Funder"</span>, <span class="kw">y</span> <span class="kw">=</span><span class="st">"Percentage of Total Grants"</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Percentage of Total Grant Values to Strategic and Systemic Change"</span>,
       <span class="kw">caption</span> <span class="kw">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span>)

<span class="no">p6</span></pre></body></html></div>
<p><img src="strategic-funders.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://evanodell.com">Evan Odell</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
